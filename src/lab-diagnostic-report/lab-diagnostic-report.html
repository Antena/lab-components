<div>
	<div ng-if="!vm.hideHeader" class="lab-diagnostic-report-info">
		<ul class="details-item-list">
			<li ng-if="vm.patient" class="details-item">
				<span class="item-name">{{ 'LAB.PATIENT' | translate | semicolon }}&nbsp;</span><span class="item-value">{{ vm.patient | patientFullName }} ({{ vm.patient.birthDate | patientAgeAtReportDate:vm.reportDate:true }})</span>
			</li>
			<li ng-if="vm.reportDate" class="details-item">
				<span class="item-name">{{ 'LAB.DATE' | translate | semicolon }}&nbsp;</span><span class="item-value">{{ vm.reportDate | customFormatDate:vm.dateFormat }}</span>
			</li>
		</ul>
		<ul class="details-item-list">
			<li ng-if="vm.organization" class="details-item">
				<span class="item-name">{{ 'LAB.ORGANIZATION' | translate | semicolon }}&nbsp;</span><span class="item-value">{{ vm.organization.name }}</span>
			</li>
			<li ng-if="vm.status" class="details-item">
				<span class="item-name">{{ 'LAB.STATUS' | translate | semicolon }}&nbsp;</span><span class="item-value">{{ vm.status | toStatusKey | translate }}&nbsp;<span class="item-value-help">({{ vm.status | toStatusKey:'_DESCRIPTION' | translate }})</span></span>
			</li>
		</ul>
	</div>

	<div ng-if="vm.observations.length" class="lab-diagnostic-report-observations split-content">

		<div class="primary-content" id="observations-container">
			<div class="observation-groups" ng-repeat="firstLevelObservation in vm.observations">

				<h2 ng-if="firstLevelObservation.related" id="{{ firstLevelObservation.id }}" class="observation-group-title">{{ getObservationDisplay(firstLevelObservation) | uppercase }}</span></h2>

				<div class="observation-gallery">
					<lab-observation ng-repeat="observation in getObservationList(firstLevelObservation)" id="{{ observation.id }}"
									 observation="observation"
									 actions="observation.actions"
									 header-actions="observation.headerActions"
									 view-only="vm.viewOnly"
									 compact-mode="vm.compactMode"
									 multi-range-mode="vm.displayObservationsWithMultipleRanges"
									 hide-title="vm.deDupeTopLevelObservations && firstLevelObservation.related && firstLevelObservation.related.length === 1"
									 patient-age-in-years="vm.patientAgeInYearsAtMomentOfReport"
									 patient-gender="vm.patientGender">
						<lab-history-graph ng-if="observation.showHistory && !!observation.history" observation-list="observation.history"></lab-history-graph>
					</lab-observation>
				</div>

			</div>
		</div>

		<div class="secondary-content">
			<div class="lab-tree">
				<ul ng-repeat="firstLevelObservation in vm.observations" ng-init="initLabTree()" class="lab-tree-group">
					<li class="lab-tree-top-level lab-tree-node lab-tree-observation-group-title" class="lab-tree-group-item">
						<a href="#{{ firstLevelObservation.id }}" du-smooth-scroll du-scrollspy offset="100">{{ getObservationDisplay(firstLevelObservation) | capitalize:true }}</a>

						<div ng-if="!isTopLevel(firstLevelObservation)" class="lab-tree-node lab-tree-observation-observation-title" ng-class="{ 'top-level-content': !isTopLevel(firstLevelObservation) }">
							<a href="#{{ observation.id }}" ng-repeat="observation in getObservationList(firstLevelObservation)" du-smooth-scroll du-scrollspy offset="100">
								<span >{{ observation.code | codeableConcept | capitalize:true }}</span>
							</a>
						</div>
					</li>
				</ul>
			</div>
		</div>

	</div>
</div>
